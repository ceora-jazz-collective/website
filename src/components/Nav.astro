---
const links = [
  { label: 'Ãœber uns', href: '/#about' },
  { label: 'Gigs', href: '/#gigs' },
  { label: 'Media', href: '/#media' },
  { label: 'Kontakt', href: '/#contact' },
];
---

<header class="site-nav" role="banner" data-site-nav>
  <nav class="site-nav__inner" aria-label="Primary">
    <a
      class="site-nav__logo"
      href="/"
      aria-label="Ceora Jazz Collective - Home"
    >
      <img
        class="site-nav__logo-img"
        src="/logo-white.svg"
        alt="Ceora Jazz Collective"
        height="30"
      />
    </a>

    <ul class="site-nav__links site-nav__links--desktop" role="list">
      {
        links.map((l) => (
          <li>
            <a class="site-nav__link" href={l.href}>
              {l.label}
            </a>
          </li>
        ))
      }
    </ul>

    <details class="site-nav__mobile">
      <summary class="site-nav__toggle" aria-label="Open menu">
        <span class="site-nav__burger" aria-hidden="true">
          <span></span>
          <span></span>
          <span></span>
        </span>
      </summary>

      <div class="site-nav__drawer" role="dialog" aria-label="Menu">
        <ul class="site-nav__links site-nav__links--mobile" role="list">
          {
            links.map((l) => (
              <li>
                <a class="site-nav__link" href={l.href}>
                  {l.label}
                </a>
              </li>
            ))
          }
        </ul>
      </div>
    </details>
  </nav>
</header>

<script>
  const header = document.querySelector('[data-site-nav]');
  const mobileMenu = header?.querySelector('.site-nav__mobile');

  function updateNavState() {
    if (!header) return;
    header.classList.toggle('is-scrolled', window.scrollY > 0);
    header.classList.toggle(
      'is-menu-open',
      !!mobileMenu && mobileMenu.hasAttribute('open')
    );
  }

  // Apply initial state and keep it in sync.
  updateNavState();
  window.addEventListener('scroll', updateNavState, { passive: true });
  mobileMenu?.addEventListener('toggle', updateNavState);
  document.addEventListener('astro:page-load', updateNavState);

  // Close the mobile menu after clicking a link.
  for (const nav of document.querySelectorAll('.site-nav__mobile')) {
    nav.addEventListener('click', (e) => {
      const t = e.target;
      if (t instanceof HTMLAnchorElement) nav.removeAttribute('open');
    });
  }
</script>
